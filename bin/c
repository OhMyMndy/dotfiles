#!/usr/bin/env bash

OLD_PWD="$PWD"
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd "$DIR"

if [[ $# -eq 1 ]];
then
	file_name="$@/commands.txt"
else
	cd "$OLD_PWD"
	file_name="$PWD/commands.txt"
fi

if [ ! -f "$file_name" ]; then
    echo "File '$file_name' does not exist!" >&2
    file_name="$HOME/commands.txt"

    if [ ! -f "$file_name" ]; then
        echo "File '$file_name' does not exist!" >&2
        exit 3
    else
        cd "$HOME"
    fi
else
    cd "$1"
fi

export PATH="$HOME/.fzf/bin/:$PATH"
echo $PATH
echo $file_name
eval "$(cat "$file_name" | fzf --height=33 --no-sort --tac)"
