#!/bin/bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
cd $DIR
TMP_IMAGE=/tmp/i3_lock.png
# suspend message display
pkill -u "$USER" -USR1 dunst

if [ "$1" != '--test' ]; then
  bash ./create-lockscreen-image && pkill -e -f i3lock && i3lock -n -i $TMP_IMAGE || i3lock -c 000000 &
  i3lock -c 000000
  rm $TMP_IMAGE
else
  bash ./create-lockscreen-image && exo-open $TMP_IMAGE
fi

# resume message display
pkill -u "$USER" -USR2 dunst
